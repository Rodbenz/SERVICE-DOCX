SELECT T1.[N_REGIST_NO]
,T1.[REGIST_NO]
,T1.[CHANGWAT_CODE]
,T1.[BRANCH]
,T1.[CONDO_NAME]
,T1.[CONDO_TYPE]
,T1.[CONDO_QUALITY]
,T1.[ADDRESS]
,T1.[ROAD]
,T1.[TUMBON_CODE]
,T1.[AMPHUR_CODE]
,T1.[ZIPCODE]
,T1.[NORTH]
,T1.[N_DISTANT]
,T1.[SOUTH]
,T1.[S_DISTANT]
,T1.[EAST]
,T1.[E_DISTANT]
,T1.[WEST]
,T1.[W_DISTANT]
,T1.[ENTER_WAY]
,T1.[ENTER_WAY_TYPE]
,T1.[UTIL_WATER]
,T1.[UTIL_ELEC]
,T1.[UTIL_PHONE]
,T1.[UTIL_OTHR]
,T1.[VIEW_EFFCT]
,T1.[ENVR_EFFCT]
,T1.[TREND_VALUE]
,T1.[BLD_FL_TOT]
,T1.[BLD_NUM]
,T1.[BLD_AREA]
,T1.[ROOM_AREA]
,T1.[PARK_LOT]
,T1.[PUBLIC_PARK]
,T1.[PRIVATE_PARK]
,T1.[ENTER_WIDTH]
,T1.[BASEMENT_TOT]
,T1.[CITY_REGUL]
,T1.[RD_DISTANT]
,T1.[ENABLE]
,T4.[S_TRAIN_TYPE]
,T4.[S_TRAIN]
,T4.[S_TRAIN_DISTANT]
,T1.[CONDO_HIGH_TYPE]
,T1.[PUBLIC_EXPENSE]
,T1.[SOI]
,T1.[TEL]
,T1.[EMAIL]
,T1.[ROAD_SELECT]
,T1.[PKEY]
,T1.[PRICE_MIN]
,T1.[PRICE_MAX]
,T1.[CONDO_REMARK]
,T1.[CONDO_S_ID]
,T1.[CONDO_TYPE_ID]
,T1.[FACILITIE_NUM]
,T1.[CON_OT_NUM]
,T2.ID_TYPE
,T2.CONDO_TYPE_NAME
,T3.[ROAD_INFO_ID]
,T3.[ROAD_NAME]
,T3.[ROAD_SURFACE]
,T3.[ROAD_DISTANCE]
,T3.[ROAD_WIDTH]
,T3.[MAIN_ROAD_NAME]
,T3.[MAIN_ROAD_SURFACE]
,T3.[MAIN_ROAD_DISTANCE]
,T3.[MAIN_ROAD_WIDTH]
,T5.ID, T5.NAMETH, T5.AMPHUR_CODE, T5.AMPHUR_Name, T5.BRANCH
,T6.TITLE_REG, T6.FNAME_REG, T6.LNAME_REG, T6.REGIST_NAME_TYP
,T7.ALLROOM
FROM [condo].[dbo].[NCONDOS] T1
LEFT JOIN
(select CONDO_TYPE_ID ID_TYPE, CONDO_TYPE_NAME from [condo].[dbo].[CONDO_TYPE]) T2
ON T1.CONDO_TYPE_ID = T2.ID_TYPE
LEFT JOIN
(SELECT [ROAD_INFO_ID]
,[CONDO_S_ID]
,[ROAD_NAME]
,[ROAD_SURFACE]
,[ROAD_DISTANCE]
,[ROAD_WIDTH]
,[MAIN_ROAD_NAME]
,[MAIN_ROAD_SURFACE]
,[MAIN_ROAD_DISTANCE]
,[MAIN_ROAD_WIDTH]
FROM [condo].[dbo].[ROAD_INFO]) T3
ON T1.CONDO_S_ID = T3.CONDO_S_ID
LEFT JOIN (
SELECT [SEQ]
,[PKEY]
,[S_TRAIN_TYPE]
,[S_TRAIN]
,[S_TRAIN_DISTANT]
,[CONDO_S_ID]
,[STATUS]
FROM [condo].[dbo].[NCONDO_TRAIN]
where STATUS = '1'
)T4
ON T1.CONDO_S_ID = T4.CONDO_S_ID
LEFT JOIN (
SELECT T1.ID, T1.NAMETH, T4.AMPHUR_CODE AS AMPHUR_CODE , T4.AMPHUR_Name AS AMPHUR_Name, T2.BRANCH
    FROM [common].[dbo].[PROVINCE] T1 WITH (NOLOCK)
    INNER JOIN [common].[dbo].[CHANGWAT_BRANCH] T2
    ON T1.ID = T2.CHANGWAT_CODE
    INNER JOIN [common].[dbo].[BRANCH_AREA] T3
    ON T2.CHANGWAT_CODE = T3.PROVINCE_CODE
    AND T2.BRANCH = T3.BRANCH_CODE
    INNER JOIN [common].[dbo].[AMPHUR] T4
    ON T2.CHANGWAT_CODE = T4.PROVINCE_CODE
    AND T3.AMPHUR_CODE = T4.AMPHUR_CODE 
GROUP BY T1.ID, T1.NAMETH, T4.AMPHUR_Name , T4.AMPHUR_CODE , T2.BRANCH
)T5
ON T1.CHANGWAT_CODE = T5.ID
AND T1.BRANCH = T5.BRANCH
AND T1.AMPHUR_CODE = T5.AMPHUR_CODE
LEFT JOIN (
  SELECT CONDO_S_ID, TITLE_REG, FNAME_REG, LNAME_REG, REGIST_NAME_TYP
  FROM condo.dbo.NCONDO_REG
)T6
ON T1.CONDO_S_ID = T6.CONDO_S_ID
LEFT JOIN (
  SELECT count(*) ALLROOM, CONDO_S_ID
  FROM [condo].[dbo].[NCONDO_HEADER]
  GROUP BY CONDO_S_ID
) T7
ON T1.CONDO_S_ID = T7.CONDO_S_ID
WHERE T1.CONDO_S_ID = @CONDO_S_ID